---
layout: post
title: C语言通用知识
categories: C语言 
tags: C语言

---

## malloc_trim()函数

介绍这个函数之前首先需要介绍一下，操作系统内存分配的一些知识。

一个程序会通过malloc等函数从操作系统申请内存，放在堆上，然后通过free来释放内存。但是实际上操作系统会做个骚操作，当程序用了free之后，也不会立马把内存收走，因为他预判你以后可能还会用，如果收走了再分配很消耗性能，所以他有时候会偷偷留着一部分内存。

这时我们就需要用到malloc_trim()函数来告诉操作系统，我确实需要你释放内存，不要保留了。

通常的用法是malloc_trim(0)，表示操作系统，能释放就尽量释放吧。

详细的用法参考：[malloc_trim](https://linux.die.net/man/3/malloc_trim)